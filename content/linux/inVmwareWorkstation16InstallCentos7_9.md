+++
title = "在VMware Workstation 16 上安装 Centos7.9"
date = 2023-10-07T11:27:22+08:00
weight = 0
type = "docs"
description = ""
isCJKLanguage = true
draft = false

+++

# 在VMware Workstation 16 上安装 Centos7.9

## CentOS7.9 安装包

- [https://mirrors.aliyun.com/centos/7.9.2009/isos/x86_64/](https://mirrors.aliyun.com/centos/7.9.2009/isos/x86_64/) 阿里镜像
- [https://mirrors.tuna.tsinghua.edu.cn/centos/7.9.2009/isos/x86_64/](https://mirrors.tuna.tsinghua.edu.cn/centos/7.9.2009/isos/x86_64/) 清华源
- [https://mirrors.ustc.edu.cn/centos/7.9.2009/isos/x86_64/](https://mirrors.ustc.edu.cn/centos/7.9.2009/isos/x86_64/) 中科大源
- [https://img.cs.montana.edu/linux/centos/7.9.2009/isos/x86_64/](https://img.cs.montana.edu/linux/centos/7.9.2009/isos/x86_64/)
- [https://mirrors.tripadvisor.com/centos/7.9.2009/isos/x86_64/](https://mirrors.tripadvisor.com/centos/7.9.2009/isos/x86_64/)

## 相关资源

- [https://installati.one/centos/7/](https://installati.one/centos/7/) 相关软件的安装说明

## 前期设置



![image-20231007113859558](inVmwareWorkstation16InstallCentos7_9_img/image-20231007113859558.png)



![image-20231007114042140](inVmwareWorkstation16InstallCentos7_9_img/image-20231007114042140.png)





![image-20231007114112812](inVmwareWorkstation16InstallCentos7_9_img/image-20231007114112812.png)





![image-20231007114204183](inVmwareWorkstation16InstallCentos7_9_img/image-20231007114204183.png)



![image-20231007114523191](inVmwareWorkstation16InstallCentos7_9_img/image-20231007114523191.png)



![image-20231007114607334](inVmwareWorkstation16InstallCentos7_9_img/image-20231007114607334.png)





![image-20231007114633954](inVmwareWorkstation16InstallCentos7_9_img/image-20231007114633954.png)





![image-20231007114657899](inVmwareWorkstation16InstallCentos7_9_img/image-20231007114657899.png)



![image-20231007114724171](inVmwareWorkstation16InstallCentos7_9_img/image-20231007114724171.png)



![image-20231007114747006](inVmwareWorkstation16InstallCentos7_9_img/image-20231007114747006.png)



![image-20231007114809692](inVmwareWorkstation16InstallCentos7_9_img/image-20231007114809692.png)



![image-20231007114858374](inVmwareWorkstation16InstallCentos7_9_img/image-20231007114858374.png)



![image-20231007115108239](inVmwareWorkstation16InstallCentos7_9_img/image-20231007115108239.png)



![image-20231007115142957](inVmwareWorkstation16InstallCentos7_9_img/image-20231007115142957.png)



![image-20231007115201743](inVmwareWorkstation16InstallCentos7_9_img/image-20231007115201743.png)





![image-20231007134658504](inVmwareWorkstation16InstallCentos7_9_img/image-20231007134658504.png)





![image-20231007134731322](inVmwareWorkstation16InstallCentos7_9_img/image-20231007134731322.png)



## 开始安装

![image-20231007134751098](inVmwareWorkstation16InstallCentos7_9_img/image-20231007134751098.png)



![image-20231007134817643](inVmwareWorkstation16InstallCentos7_9_img/image-20231007134817643.png)





![image-20231007134830142](inVmwareWorkstation16InstallCentos7_9_img/image-20231007134830142.png)



![image-20231007134951789](inVmwareWorkstation16InstallCentos7_9_img/image-20231007134951789.png)



![image-20231007135056383](inVmwareWorkstation16InstallCentos7_9_img/image-20231007135056383.png)



![image-20231007135322871](inVmwareWorkstation16InstallCentos7_9_img/image-20231007135322871.png)



![image-20231007135248954](inVmwareWorkstation16InstallCentos7_9_img/image-20231007135248954.png)



![image-20231007135536033](inVmwareWorkstation16InstallCentos7_9_img/image-20231007135536033.png)



![image-20231007135719549](inVmwareWorkstation16InstallCentos7_9_img/image-20231007135719549.png)



![image-20231007135409600](inVmwareWorkstation16InstallCentos7_9_img/image-20231007135409600.png)



![image-20231007135502848](inVmwareWorkstation16InstallCentos7_9_img/image-20231007135502848.png)



![image-20231007135758782](inVmwareWorkstation16InstallCentos7_9_img/image-20231007135758782.png)



![image-20231007140238095](inVmwareWorkstation16InstallCentos7_9_img/image-20231007140238095.png)



![image-20231007140310908](inVmwareWorkstation16InstallCentos7_9_img/image-20231007140310908.png)



![image-20231007140404889](inVmwareWorkstation16InstallCentos7_9_img/image-20231007140404889.png)



![image-20231007140501422](inVmwareWorkstation16InstallCentos7_9_img/image-20231007140501422.png)



![image-20231007140522984](inVmwareWorkstation16InstallCentos7_9_img/image-20231007140522984.png)



![image-20231007142401488](inVmwareWorkstation16InstallCentos7_9_img/image-20231007142401488.png)



![image-20231007142825735](inVmwareWorkstation16InstallCentos7_9_img/image-20231007142825735.png)



![image-20231007142850667](inVmwareWorkstation16InstallCentos7_9_img/image-20231007142850667.png)

![image-20231007203137778](inVmwareWorkstation16InstallCentos7_9_img/image-20231007203137778.png)



![image-20231007203154645](inVmwareWorkstation16InstallCentos7_9_img/image-20231007203154645.png)



![image-20231007143044289](inVmwareWorkstation16InstallCentos7_9_img/image-20231007143044289.png)



![image-20231007143101657](inVmwareWorkstation16InstallCentos7_9_img/image-20231007143101657.png)



![image-20231007143848071](inVmwareWorkstation16InstallCentos7_9_img/image-20231007143848071.png)

## 更新yum源和升级

```bash
su - root

# 备份原有的yum源配置文件
mv /etc/yum.repost.d/CentOS-Base.repo /etc/yum.repos.d/CentOS-Base.bak

# 使用阿里云的yum源，获取新的配置文件
wget -O /etc/yum.repos.d/CentOS-Base.repo https://mirrors.aliyun.com/repo/Centos-7.repo

# 作用：清除yum缓存。 yum 会把下载的软件包和header存储在cache中，而不自动删除
yum clean all

# 升级包、软件和系统内核,而 yum -y upgrade只升级包，而不升级软件和系统内核
yum -y update
```

![image-20231007144608643](inVmwareWorkstation16InstallCentos7_9_img/image-20231007144608643.png)



![image-20231007145712691](inVmwareWorkstation16InstallCentos7_9_img/image-20231007145712691.png)



![image-20231007150445179](inVmwareWorkstation16InstallCentos7_9_img/image-20231007150445179.png)



![image-20231007150544366](inVmwareWorkstation16InstallCentos7_9_img/image-20231007150544366.png)





![image-20231007154727579](inVmwareWorkstation16InstallCentos7_9_img/image-20231007154727579.png)



## 安装 vmware-tools

![image-20231007160625007](inVmwareWorkstation16InstallCentos7_9_img/image-20231007160625007.png)



在输入以下命令行：

```bash
mkdir -p /mnt/cdrom

mount /dev/cdrom /mnt/cdrom

cp /mnt/cdrom/VMwareTools-10.3.23-16594550.tar.gz /tmp

umount /dev/cdrom

tar -zxvf VMwareTools-10.3.23-16594550.tar.gz

cd /tmp/vmware-tools-distrib/

./vmware-install.pl

# 出现 [yes] 则输入 yes
# 出现 [no] 则直接按Enter
```



![image-20231007162018749](inVmwareWorkstation16InstallCentos7_9_img/image-20231007162018749.png)

## 安装和更新epel源

epel（Extra Packages for Enterprise Linux）是一个软件源，里面包含了许多基本源中不存在的软件。

它由Fedora Project 推出。

网址：[http://fedoraproject.org/wiki/EPEL](http://fedoraproject.org/wiki/EPEL)

```bash
# 安装
yum install -y epel-release

# 备份
cd /etc/yum.repos.d
mv epel.repo epel.repo.bak

# 获取新的epel.repo
wget -O epel.repo https://mirrors.aliyun.com/repo/epel-7.repo

```

![image-20231007221054360](inVmwareWorkstation16InstallCentos7_9_img/image-20231007221054360.png)

![image-20231007223440601](inVmwareWorkstation16InstallCentos7_9_img/image-20231007223440601.png)

## 设置关屏时间为Never

![image-20231008184927061](inVmwareWorkstation16InstallCentos7_9_img/image-20231008184927061.png)



![image-20231008184951363](inVmwareWorkstation16InstallCentos7_9_img/image-20231008184951363.png)

## 设置中文输入法





![image-20231008164358232](inVmwareWorkstation16InstallCentos7_9_img/image-20231008164358232.png)

![image-20231008164514309](inVmwareWorkstation16InstallCentos7_9_img/image-20231008164514309.png)

![image-20231008164537123](inVmwareWorkstation16InstallCentos7_9_img/image-20231008164537123.png)





![image-20231008164617351](inVmwareWorkstation16InstallCentos7_9_img/image-20231008164617351.png)

<img src="inVmwareWorkstation16InstallCentos7_9_img/image-20231008164652003.png" alt="image-20231008164652003" style="zoom:50%;" />

![image-20231008164708728](inVmwareWorkstation16InstallCentos7_9_img/image-20231008164708728.png)

![image-20231008164746664](inVmwareWorkstation16InstallCentos7_9_img/image-20231008164746664.png)

![image-20231008164806585](inVmwareWorkstation16InstallCentos7_9_img/image-20231008164806585.png)

![image-20231008164830903](inVmwareWorkstation16InstallCentos7_9_img/image-20231008164830903.png)

## 防火墙设置

查看防火墙状态

```cmd
sudo systemctl status firewalld

# 或

sudo firewall-cmd --state
```

示例

```cmd
[root@master ~]# systemctl status firewalld
● firewalld.service - firewalld - dynamic firewall daemon
   Loaded: loaded (/usr/lib/systemd/system/firewalld.service; disabled; vendor preset: enabled)
   Active: inactive (dead)
     Docs: man:firewalld(1)
[root@master ~]# sudo firewall-cmd --state
not running
[root@master ~]# systemctl start firewalld
[root@master ~]# sudo firewall-cmd --reload
success
[root@master ~]# firewall-cmd --state
running
```

> 注：一般情况下防火墙是默认已经安装好的

安装和卸载防火墙

```cmd
# 安装
sudo yum install firewalld
# 安装好的防火墙默认是 inactive 的状态

# 卸载
# 注意，这样卸载并不会删除之前设置好的防火墙规则
sudo apt remove ufw -y
```

自动开机启动防火墙

```cmd
sudo systemctl enable firewalld
```

禁止自动开机启动防火墙

```cmd
sudo systemctl disable firewalld
```

当前停用防火墙

```cmd
sudo systemctl stop firewalld
```

当前启用防火墙

```cmd
sudo systemctl start firewalld
```

当前重启防火墙

```cmd
# 先停止防火墙服务，再重新加载防火墙规则配置，最后再重新启动，这样会中断现有的连接。
sudo systemctl restart firewalld

# 或
# 只是重新加载防火墙规则配置，而不会停止防火墙服务，同时不会中断现有的连接。
sudo firewall-cmd --reload
```

查看已设置的防火墙规则

查看所有防火墙规则

```cmd
sudo firewall-cmd --list-all
```

查看已打开的端口

```cmd
sudo firewall-cmd --list-ports
```

查看指定区域的防火墙规则（例如，public、internal、dmz 等）：

```cmd
sudo firewall-cmd --zone=public --list-all
```

设置允许通过防火墙的规则

> 提示
>
> ​	设置防火墙规则后，记得重新启动防火墙服务，这样才能看到新设置的防火墙规则。

添加端口

示例

```cmd
sudo firewall-cmd --zone=public --add-port=80/tcp --permanent
```

去除端口

示例

```cmd
sudo firewall-cmd --zone=public --remove-port=8080/tcp --permanent
```





## 克隆 <- 重要

![image-20231007215544862](inVmwareWorkstation16InstallCentos7_9_img/image-20231007215544862.png)



![image-20231007215604455](inVmwareWorkstation16InstallCentos7_9_img/image-20231007215604455.png)



![image-20231007215624158](inVmwareWorkstation16InstallCentos7_9_img/image-20231007215624158.png)



![image-20231007215642573](inVmwareWorkstation16InstallCentos7_9_img/image-20231007215642573.png)



![image-20231007215715250](inVmwareWorkstation16InstallCentos7_9_img/image-20231007215715250.png)

![image-20231007215434932](inVmwareWorkstation16InstallCentos7_9_img/image-20231007215434932.png)



## 安装搜狗输入法  <-  待处理（目前重启后还是有问题）

```bash
#
yum -y install fcitx-configtool libQtWebKit* fcitx im-chooser fcitx-qt5

# 
yum -y install alien dpkg

# 切换至 /tmp
cd /tmp

# 怎么获取不同版本？
wget http://cdn2.ime.sogou.com/dl/index/1524572264/sogoupinyin_2.2.0.0108_amd64.deb

# 
alien -r --scripts sogoupinyin_2.2.0.0108_amd64.deb

# 强行安装sogou
rpm -ivh --force sogoupinyin-2.2.0.0108-2.x86_64.rpm

# 
cp /usr/lib/x86_64-linux-gnu/fcitx/fcitx-sogoupinyin.so /usr/lib64/fcitx/

# 切换输入法为fcitx
imsettings-switch fcitx  

# 弹出输入法配置框
fcitx-configtool

# 重新启动
reboot
```

## 安装 docker

```cmd
# 查看系统版本
# 因 docker 在Centos系统中至少需要的版本是7，作为其基础系统，且建议系统内核版本不低于3.10
# 查看系统版本
cat /etc/centos-release
# 查看系统内核版本
uname -a

# 安装 yum-utils
# 说明：device-mapper-persistent-data是Linux下存储技术（DeviceMapper）的驱动
sudo yum install -y yum-utils device-mapper-persistent-data lvm2

# 安装 docker 安装源
sudo yum-config-manager --add-repo https://mirrors.aliyun.com/docer-ce/linux/centos/docker-ce.repo
sudo sed -i 's+download.docekr.com+mirrors.aliyun.com/docker-ce+' /etc/yum.repos.d/docker-ce.repo
# 提前在本地创建软件包索引缓存，以此来提高搜索和安装软件的速度
sudo yum makecache fast

# 安装社区版 docker
# ce 版本为免费的社区版， ee 版本为收费的企业版
# docker-ce-cli 是 docker Engine 的命令行界面
# containerd.io 是容器运行时的基本组件，负责管理容器的生命周期、镜像管理和存储
# docekr-buildx-plugin 是官方提供的构建工具，可快速、高效地构建 docker 镜像，并支持跨平台
# docker-compose-plugin 是容器编排插件。允许通过一个配置文件来描述服务，并通过命令来管理这些服务
sudo yum install -y docker-ce docker-ce-cli containerd.io docker-buildx-plugin docker-compose-plugin

# 说明： docker 应用需要用到各种端口，因此之后每启动一个容器都应逐一到防火墙开放对应端口，否则容器无法启动。为避免因此带来的繁琐操作，建议在启动 docker 服务前将防火墙关闭！
# 关闭防火墙
sudo systemctl stop firewalld
# 禁止防火墙在开机时自动启动
sudo systemctl disable firewalld

# 启动 docker 服务
sudo systemctl start docker

# 镜像加速
# docker 官方镜像仓库网速较差，最好设置国内镜像站点
# 参考：https://cr.console.aliyun.com/cn-hangzhou/instances/mirrors
# 例如：
sudo mkdir -p /etc/docker
sudo tee /etc/docker/daemon.json <<-'EOF'
{
  "registry-mirrors": ["https://te93ynsd.mirror.aliyuncs.com"]
}
EOF
sudo systemctl daemon-reload
sudo systemctl restart docker

# 测试安装
# 查看 docker 引擎版本
docker -v

# 查看 docker-compose 版本
docker compose version

# 拉取 hello-world镜像
docker pull hello-world
# 启动 hello-world镜像
docker run hello-world
```



## 卸载 docker

```cmd
# 停止 docker 服务
sudo systemctl stop docker

# 查看已安装的 docker 软件包
sudo yum list installed | grep docker

# 卸载已安装的 docker 软件包
sudo yum remove containerd.io.x86_64 docker* -y

# 删除 docker 数据和配置文件
# 删除存放容器、镜像、卷、网络的配置
sudo rm -rf /var/lib/docker 
# 删除管理 docker 容器生命周期的组件（docker 容器的运行环境）
sudo rm -rf /var/lib/containerd
# 删除 docker 的配置文件
sudo rm -rf /etc/docker


```

